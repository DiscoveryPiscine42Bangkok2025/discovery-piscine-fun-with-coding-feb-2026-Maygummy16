<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Resume - Piscine Discovery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>

<body data-bs-spy="scroll" data-bs-target="#icon-nav">

    <!--iconด้านซ้าย พวกโฮมต่างๆ-->
    <nav id="icon-nav" class="icon-nav-group">
        <a class="nav-link-icon" href="index.html" title="หน้าโฮม"><i class="bi bi-house"></i></a>
        <a class="nav-link-icon" href="#part1" title="โปรไฟล์"><i class="bi bi-person"></i></a>
        <a class="nav-link-icon" href="#part2" title="สกิล"><i class="bi bi-gear"></i></a>
        <a class="nav-link-icon" href="#part3" title="ช่องทางการติดต่อ"><i class="bi bi-chat-left-dots"></i></a>
    </nav>

    <!--โปรไฟ ตอนเเรกว่างเเต่ รอjavaมาใส่ข้อมุล-->
    <div class="container">
        <section id="part1">
            <div class="glass-card text-center w-100">
                <img id="photo" src="" alt="Profile" class="profile-photo">
                <h1 id="name" class="display-2 fw-bold mb-1"></h1>
                <h2 id="job" class="text-primary h3 mb-4"></h2>
                <p id="intro" class="lead text-muted mx-auto" style="max-width: 700px;"></p>
            </div>
        </section>

        <!--ประสบการ การทํางาน-->
        <section id="part2">
            <div class="w-100">
                <h2 class="section-title text-center d-block display-5">ประวัติการทำงาน</h2>
                <div class="row g-4 mt-2">
                    <div class="col-lg-7">
                        <div class="glass-card h-100">
                            <h3 class="h4 mb-4"><i class="bi bi-briefcase me-2"></i>ประสบการณ์ทำงาน</h3>
                            <div id="experience"></div> < <!--ประสบการ การทํางาน-->
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <div class="glass-card h-100">
                            <h3 class="h4 mb-4"><i class="bi bi-lightning-charge me-2"></i>ความสามารถพิเศษ</h3>
                            <div id="skills-list" class="d-flex flex-wrap gap-2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="part3">
            <div class="glass-card text-center w-100">
                <h2 class="section-title display-5">ช่องทางการติดต่อ</h2>
                <p class="text-muted mb-5 fs-5">หากสนใจร่วมงานหรือร่วมโปรเจกต์ สามารถติดต่อได้ที่นี่</p>
                <div id="contact-links" class="d-flex justify-content-center flex-wrap gap-5"></div>
            </div>
        </section>
    </div>

    <script>
        <!--ดึงuserจากurl-->
        async function loadResume() {
            const params = new URLSearchParams(window.location.search);
            const user = params.get('user') || '1';

            try {
                <!--โหลดไฟเจสัน-->
                const response = await fetch(`resume${user}.json`);
                if (!response.ok) throw new Error("Data not found");
                const data = await response.json();
                console.log("Full data object:", data);
                console.log("Type of experience:", typeof data.experience_skills.experience);
                console.log("Is array?", Array.isArray(data.experience_skills.experience));

                <!--เอาชื่อจากjsonมาใส่หน้าเวบ-->
                document.getElementById('name').innerText = data.profile.name;
                document.getElementById('job').innerText = data.profile.job_title;
                document.getElementById('intro').innerText = data.profile.introduction || "Welcome to my portfolio.";
                document.getElementById('photo').src = data.profile.photo_url;

                const expContainer = document.getElementById('experience');
                expContainer.innerHTML = ""; 

                data.experience_skills.experience.forEach(item => {
                    const expWrapper = document.createElement('div');
                    expWrapper.className = "mb-4"; 

                    expWrapper.innerHTML = `
                        <h4 class="fw-bold text-dark h5">${item.title}</h4>
                        <p class="text-secondary small mb-0">${item.description}</p>
    `;
                    expContainer.appendChild(expWrapper);
                });

                const skillsDiv = document.getElementById('skills-list');
                skillsDiv.innerHTML = "";
                data.experience_skills.skills.forEach(skill => {
                    const span = document.createElement('span');
                    span.className = 'badge-skill';
                    span.innerText = skill;
                    skillsDiv.appendChild(span);
                });

                const contactDiv = document.getElementById('contact-links');
                contactDiv.innerHTML = "";

                for (const [key, details] of Object.entries(data.contact)) {
                    contactDiv.innerHTML += `
                    <div class="contact-item text-center">
                        <div class="mb-2">
                            <i class="bi ${details.icon} text-primary" style="font-size: 2rem;"></i>
                        </div>
                        <div class="small text-uppercase fw-bold text-muted">${key}</div>
                        <div class="fs-5 fw-medium">${details.value}</div>
                    </div>`;
                }
            } catch (err) {
                console.error("DEBUG:", err)
                document.body.innerHTML = `
                <div class='text-center mt-5 p-5'>
                    <h1 class='text-danger'>Error Loading Data</h1>
                    <p class='lead'>${err.message}</p>
                    <p>Check your browser console (F12) for details.</p>
                </div>`;
            }
        }
        window.onload = loadResume;
    </script>
</body>

</html>